
å¤§å®¶å¥½ï¼Œå›½åº†èŠ‚å¿«ä¹ï¼Œ`Known`åˆæ›´æ–°äº†ä¸€æ³¢åŠŸèƒ½ã€‚


ç»§ä¸Šä¸ªç‰ˆæœ¬ä»¥æ¥ï¼Œä¸€ç›´åœ¨å®Œå–„ç½‘ç«™æ–‡æ¡£ã€`KnownCMS`å¼€æºé¡¹ç›®å’Œè§£å†³æ¡†æ¶å®¢æˆ·æå‡ºçš„ä¸€äº›é—®é¢˜ã€‚è¿™æœŸé—´å®¢æˆ·åé¦ˆçš„é—®é¢˜ä¸»è¦å¦‚ä¸‹ï¼š


* å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯æ”¶ä¸åˆ°ï¼ŒæŸ¥å…¶åŸå› æ˜¯ç½‘ç»œé—®é¢˜ï¼Œå› æ­¤æœ¬ç‰ˆæœ¬æ”¹æˆåå°ä»»åŠ¡å‘é€æ¶ˆæ¯
* æ— ä»£ç é¡µé¢æ¨¡æ¿éœ€è¦è‡ªå®šä¹‰
* æ— ä»£ç è¡¨å•å­—æ®µç»„ä»¶éœ€è¦è‡ªå®šä¹‰
* æ•°æ®åº“è®¿é—®éœ€è¦æ”¯æŒ`EFCore`
* æœ‰äº›ç½‘å‹æµ‹è¯•éå¸¸ç»†è‡´ï¼Œå‘ç°äº†ä¸€äº›`BUG`


## æ›´æ–°å†…å®¹


* ğŸ”¨æ”¯æŒæ‰‹åŠ¨åˆ·æ–°å¾®ä¿¡è®¿é—®`Token`
* ğŸ”¨ä¼˜åŒ–å¯åŠ¨ç¨‹åºé”™è¯¯æ—¥å¿—
* ğŸ˜„`Known.SqlSugar`ä»é¡¹ç›®ç‹¬ç«‹å‡ºæ¥ä¸€ä¸ªæ–°åº“
* ğŸ›ä¿®å¤åµŒå…¥`iFrame`é¡µé¢æ‰“ä¸å¼€é—®é¢˜
* ğŸ›ä¿®å¤ç³»ç»Ÿè®¸å¯å¯†é’¥éªŒè¯é¢æ¿é—®é¢˜
* ğŸ›ä¿®å¤é«˜çº§æœç´¢å­—æ®µæ˜¾ç¤ºé—®é¢˜
* ğŸ›ä¿®å¤æ•°æ®å­—å…¸æ— ç±»åˆ«æ–°å¢é—®é¢˜
* ğŸ›ä¿®å¤æ— ä»£ç æ¨¡å—æ—¥æœŸæŸ¥è¯¢æ¡ä»¶æ§ä»¶é—®é¢˜
* ğŸ›ä¿®å¤å¼‚æ­¥å¯¼å…¥æ–‡å­—ä¸æ˜¾ç¤ºé—®é¢˜
* ğŸ˜„å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯å‘é€å¢åŠ åå°ä»»åŠ¡è®°å½•
* ğŸ˜„è‡ªåŠ¨è¡¨æ ¼é¡µé¢å¢åŠ è‡ªå®šä¹‰é…ç½®é€‰é¡¹
* ğŸ˜„è¡¨æ ¼è¡Œæ”¯æŒåŒå‡»äº‹ä»¶
* ğŸ”¨ä¼˜åŒ–è¡¨æ ¼æŸ¥çœ‹å’Œç¼–è¾‘å¤šæ¬¡å¼¹çª—é—®é¢˜
* ğŸ˜„è¡¨å•å­—æ®µç±»å‹æ”¯æŒæ‰©å±•çš„è‡ªå®šä¹‰ç»„ä»¶
* ğŸ”¨ä¼˜åŒ–`Database`ç»„ä»¶ï¼Œæ”¯æŒ`EFCore`
* ğŸ”¨ä¼˜åŒ–å¯¼å…¥ç»„ä»¶æç¤ºä¿¡æ¯åˆ·æ–°é—®é¢˜
* ğŸ”¨`IDataRepository`æ”¹æˆä¾èµ–æ³¨å…¥


## è¯¦ç»†å†…å®¹


1. å¢åŠ äº†ç‹¬ç«‹é¡¹ç›®å­˜å‚¨ç¬¬ä¸‰æ–¹æ•°æ®åº“è®¿é—®ç»„ä»¶ï¼Œé¡¹ç›®åœ°å€å¦‚ä¸‹



> [https://gitee.com/known/known\-db](https://github.com)


2. è‡ªå®šä¹‰é¡µé¢é…ç½®


* åœ¨å‰ç«¯é¡¹ç›®`AppClient.cs`ä¸­é…ç½®å¦‚ä¸‹



```


|  | public static class AppClient |
| --- | --- |
|  | { |
|  | public static void AddSampleRazor(this IServiceCollection services) |
|  | { |
|  | // é…ç½®å»ºé€ è‡ªåŠ¨è¡¨æ ¼é¡µé¢æ–¹æ³•å§”æ‰˜ |
|  | UIConfig.AutoTablePage = (b, m) => b.Component().Set(c => c.Model, m).Build(); |
|  | } |
|  | } |


```

* æ·»åŠ è‡ªå®šä¹‰è‡ªåŠ¨è¡¨æ ¼é¡µé¢ç»„ä»¶`CustomTablePage.razor`é¡µé¢



```


|  | @inherits BaseComponent |
| --- | --- |
|  |  |
|  | <div>@Model?.PageNamediv> |
|  |  |
|  | @code { |
|  | // è‡ªåŠ¨è¡¨æ ¼é¡µé¢é…ç½®æ¨¡å‹ |
|  | [Parameter] public TableModel> Model { get; set; } |
|  | } |


```

3. è‡ªå®šä¹‰è¡¨å•å­—æ®µç»„ä»¶


* å½“æ¡†æ¶å†…ç½®çš„è¡¨å•å­—æ®µç»„ä»¶`Input`ã€`Select`ç­‰ä¸æ»¡è¶³ä¸šåŠ¡éœ€æ±‚æ—¶ï¼Œæ¡†æ¶å¯ä»¥æ”¯æŒåœ¨é¡¹ç›®ä¸­è‡ªå®šä¹‰
* åœ¨ã€æ¨¡å—ç®¡ç†\-è¡¨å•é…ç½®ã€‘ä¸­ï¼Œå­—æ®µç±»å‹é€‰æ‹©`Custom`æ—¶ï¼Œå¯ä»¥é€‰æ‹©é¡¹ç›®ä¸­è‡ªå®šä¹‰çš„å­—æ®µç»„ä»¶
* å¦‚ä½•åœ¨è¿™é‡Œèƒ½é€‰æ‹©è‡ªå·±æ‰©å±•çš„è‡ªå®šä¹‰å­—æ®µç»„ä»¶ï¼Œåªè¦ç»„ä»¶ç»§æ‰¿`ICustomField`æ¥å£å³å¯ï¼Œç¤ºä¾‹å¦‚ä¸‹



```


|  | // CustomFieldæ˜¯æ¡†æ¶é»˜è®¤æŠ½è±¡è‡ªå®šä¹‰ç»„ä»¶åŸºç±»ï¼Œå¯ä»¥æ¢æˆé¡¹ç›®ä¸­ä»»ä½•ç»„ä»¶ |
| --- | --- |
|  | // ICustomFieldå¿…é¡»è¦ç»§æ‰¿ï¼Œå¦åˆ™åœ¨çº¿è¡¨å•ä¸­ä¸ä¼šæ˜¾ç¤º |
|  | class MyField : CustomField, ICustomField |
|  | { |
|  | protected override void BuildRender(RenderTreeBuilder builder) |
|  | { |
|  | // åœ¨è¿™é‡Œæ„å»ºä½ çš„è‡ªå®šä¹‰ç»„ä»¶å†…å®¹ï¼Œä¾‹å¦‚ä¸€ä¸ªæŒ‰é’® |
|  | builder.Button("è‡ªå®šä¹‰", this.Callback(OnClick)); |
|  | } |
|  |  |
|  | private void OnClick(MouseEventArgs args) { } |
|  | } |


```

* æ•ˆæœå¦‚ä¸‹
![image](https://img2024.cnblogs.com/blog/21278/202410/21278-20241002201707246-2067054318.gif)


4. `EFCore`é…ç½®å¦‚ä¸‹


* åœ¨`XXX.Web`é¡¹ç›®ä¸­å¼•ç”¨



```


|  | <Project Sdk="Microsoft.NET.Sdk.Web"> |
| --- | --- |
|  | <ItemGroup> |
|  | <PackageReference Include="Known.EntityFramework" Version="1.0.0" /> |
|  |  |
|  | <PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer" Version="8.0.8" /> |
|  | ItemGroup> |
|  | Project> |


```

* åœ¨`Program.cs`æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç 



```


|  | builder.Services.AddKnownEntityFramework(option => |
| --- | --- |
|  | { |
|  | // é…ç½®æ•°æ®åº“ |
|  | option.OnConfig = c => c.UseSqlServer(builder.Configuration.GetSection("ConnString").Get<string>()); |
|  | // åœ¨æ­¤é…ç½®ä¸šåŠ¡åº“æ•°æ®æ¨¡å‹ |
|  | //option.OnModel = m => m.Entity(); |
|  | }); |


```

 æœ¬åšå®¢å‚è€ƒ[é£æ•°æœºåœº](https://ze16.com)ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
